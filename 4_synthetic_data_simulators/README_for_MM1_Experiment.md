# M/M/1 Experiment (To Be Improved)


### 1.0 Synthetic Data Generation and M/M/1 Experiment Overview...

1. From M/M/1 simulator (generated by using **"q_intervention.py"** in the **"0 Simulators"** folder), we can generate the following 2 files:
    * "data_NIS.csv" --> This file contain all the data about the number of patients in the system by timestamps.
    * "data_WIQ_TIS.csv" --> This file contains all the data about the wait time of patients as well as the total time patients stay in system.

2. To bridge the gap between 1) the data files that M/M/1 simulator generates and 2) the data generated from the M/G(n)/Infinity Random Forest code, we first need to merge the data from the 2 files in order to make the data easily readable and manipulatable via pandas DataFrame. This data (after merge) is saved in the files **"MM1_baseline.csv"** and **"MM1_baseline_separate_nis.csv"**. The first one is when the NIS is general (both consult and no consult altogether), while the second one is when the NIS counts are kept separate for consult patients and no consult patients. The notebooks for merging the data generated from the M/M/1 simulator are **"MM1 Baseline general nis.ipynb"** and **"MM1 Baseline - separate nis.ipynb"**. In each of these 2 notebooks, they also include code for calculating intervention for naive(baseline) and for creating LOS distribution plots. To generate histograms, refer to the code for the NYGH data.

3. Finally, for running the M/G(n)/Infinity simulation on the data generated by the M/M/1 simulator, use the file **"nygh_simulation_4_mm1.py"** This is the file to modify and improve for the M/M/n experiment.


### 2.0 In terms of the files in the folders "1 General NIS Files" and "2 Separate NIS For Consult + No Consult Files"...

1. Take **"2 Separate NIS For Consult + No Consult Files"** as an example, the following are the steps for the overall experiment procedure:
    * Use the M/M/1 simulator to generate synthetic data saved in **"data_NIS.csv"** and **"data_WIQ_TIS.csv"**.
    
    * Run the first portion of the Jupyter notebook **"MM1 Baseline - separate nis.ipynb"** to merge the previous 2 files into 1 file for the purpose of the M/M/1 experiment: **"MM1_baseline_separate_nis.csv"**
  
    * Run **"nygh_simulation_4_mm1.py"** for the purpose of the analysis. For example: out-of-sample testing by training the model on customers #10,001 to #30,000 and testing on customers #30,001 to #40,000. Running the code will generate 2 files: 
        1) Actual LOS data --> **"LOS_Dist_Actual_MM1 - train10-30k test30-40k.csv"**, and 
        2) Simulated LOS data --> **"LOS_Dist_Simulated_MM1 - train10k-30k test30k-40k (1run).csv"**
  
    * Then go back to the Jupyter notebook **"MM1 Baseline - separate nis.ipynb"** to:
        1) Calculate the naive baseline by running code in the "Naive Calculation" section
        2) Generate the LOS distribution plots by running the code after "Naive Calculation" section


### 3.0 Comments on the M/M/1 experiment code...
* There still remains some work on modifying the "nygh_simulation_4_mm1.py" code for simulating for n servers and for improving the way that simulated data is saved.
* The code in the Jupyter notebooks can be improved and simplified. The current LOS distribution plots in the notebook may need to be replaced by code for generating histograms (like in NYGH). The NYGH code can serve as a reference for plotting histograms.
